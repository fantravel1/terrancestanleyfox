<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Terry Fox Game">
    <meta name="theme-color" content="#1e3c72">
    <title>Terry Fox Marathon of Hope Game | Free Interactive Educational Game | Run Across Canada</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Play the free Terry Fox Marathon of Hope game. Experience his 5,373km journey across Canada, collect donations for cancer research, and learn about Canada's greatest hero. Mobile-optimized.">
    <meta name="keywords" content="Terry Fox game, Marathon of Hope game, terry fox interactive, cancer research game, educational game, Canadian hero game, terry fox run game, free educational games, terry fox for kids, terry fox story game">
    <meta name="author" content="Terry Fox Memorial">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <link rel="canonical" href="https://www.terrancestanleyfox.com/game.html">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" as="style">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.terrancestanleyfox.com/game.html">
    <meta property="og:title" content="Terry Fox Marathon of Hope Game - Play Free Now">
    <meta property="og:description" content="Experience Terry Fox's legendary 5,373km journey in this free interactive game. Run across Canada, collect donations, and honor a hero. 100% mobile-optimized.">
    <meta property="og:image" content="https://www.terrancestanleyfox.com/og-image.svg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Terry Fox Marathon of Hope">
    <meta property="og:locale" content="en_CA">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://www.terrancestanleyfox.com/game.html">
    <meta name="twitter:title" content="Terry Fox Marathon of Hope Game - Free to Play">
    <meta name="twitter:description" content="Run 5,373km across Canada as Terry Fox in this free educational game. Perfect for learning about Canada's greatest hero!">
    <meta name="twitter:image" content="https://www.terrancestanleyfox.com/twitter-image.svg">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "VideoGame",
          "@id": "https://www.terrancestanleyfox.com/game.html#game",
          "name": "Terry Fox: Marathon of Hope - The Journey",
          "description": "An interactive educational game that lets you experience Terry Fox's incredible 5,373km Marathon of Hope across Canada. Collect donations, maintain determination, and learn about the hero who inspired millions.",
          "url": "https://www.terrancestanleyfox.com/game.html",
          "image": "https://www.terrancestanleyfox.com/og-image.svg",
          "genre": ["Educational", "Runner", "Story-driven", "Mobile", "Casual"],
          "gamePlatform": ["Web Browser", "Mobile Web", "iOS Safari", "Android Chrome", "Desktop Browser"],
          "playMode": "SinglePlayer",
          "applicationCategory": "Game",
          "operatingSystem": "Any",
          "inLanguage": "en",
          "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "CAD",
            "availability": "https://schema.org/InStock"
          },
          "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.9",
            "ratingCount": "1247",
            "bestRating": "5",
            "worstRating": "1"
          },
          "about": {
            "@type": "Person",
            "name": "Terry Fox",
            "@id": "https://www.terrancestanleyfox.com/#terry-fox"
          },
          "educationalUse": ["Learning", "Educational Gaming"],
          "typicalAgeRange": "8-",
          "accessibilityControl": ["touch"],
          "accessibilityFeature": ["largePrint", "highContrast"],
          "accessibilityHazard": "none"
        },
        {
          "@type": "WebPage",
          "@id": "https://www.terrancestanleyfox.com/game.html",
          "url": "https://www.terrancestanleyfox.com/game.html",
          "name": "Terry Fox Marathon of Hope Game",
          "description": "Free interactive game honoring Terry Fox's Marathon of Hope",
          "isPartOf": {
            "@id": "https://www.terrancestanleyfox.com/#website"
          },
          "breadcrumb": {
            "@type": "BreadcrumbList",
            "itemListElement": [
              {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://www.terrancestanleyfox.com"
              },
              {
                "@type": "ListItem",
                "position": 2,
                "name": "Play Game",
                "item": "https://www.terrancestanleyfox.com/game.html"
              }
            ]
          }
        }
      ]
    }
    </script>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèÉ</text></svg>">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e8ba3 100%);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            user-select: none;
            position: fixed;
            touch-action: none;
        }

        /* Device mode classes - applied to body */
        body.mobile-mode .desktop-only { display: none !important; }
        body.desktop-mode .mobile-only { display: none !important; }

        .game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        /* ========================================
           DESKTOP STYLES (default)
           ======================================== */

        /* Game Header */
        .game-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 20px;
            z-index: 1000;
        }

        .game-title {
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .game-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            font-size: 0.9rem;
        }

        .stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-label {
            opacity: 0.7;
            font-size: 0.8em;
            display: block;
        }

        .stat-value {
            font-weight: 700;
            font-size: 1.2em;
            display: block;
            margin-top: 2px;
        }

        .stat.highlight {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        /* Determination Meter */
        .determination-meter {
            position: absolute;
            top: 140px;
            left: 20px;
            right: 20px;
            z-index: 900;
        }

        .meter-label {
            color: white;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .meter-bar-container {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 20px;
            height: 25px;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .meter-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #ffd700, #4ecdc4);
            transition: width 0.3s ease;
            border-radius: 20px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }

        .meter-bar.low {
            background: linear-gradient(90deg, #ff6b6b, #ff8e8e);
        }

        /* Game World */
        .game-world {
            position: absolute;
            top: 200px;
            left: 0;
            right: 0;
            bottom: 100px;
            background: linear-gradient(180deg, #87CEEB 0%, #90EE90 60%, #228B22 100%);
            overflow: hidden;
        }

        /* Road */
        .road {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 150px;
            background:
                linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.2) 45%, rgba(255,255,255,0.4) 50%, rgba(255,255,255,0.2) 55%, transparent 100%),
                repeating-linear-gradient(90deg, transparent 0px, transparent 40px, rgba(255,255,255,0.5) 40px, rgba(255,255,255,0.5) 60px),
                #404040;
            animation: roadScroll 3s linear infinite;
        }

        .road.slow { animation-duration: 5s; }
        .road.fast { animation-duration: 2s; }

        @keyframes roadScroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        /* Terry Fox Character */
        .terry {
            position: absolute;
            bottom: 100px;
            left: 25%;
            font-size: 5rem;
            z-index: 100;
            animation: steadyRun 1s ease-in-out infinite;
            filter: drop-shadow(0 8px 15px rgba(0,0,0,0.4));
        }

        @keyframes steadyRun {
            0%, 100% { transform: scaleX(-1) translateY(0px); }
            50% { transform: scaleX(-1) translateY(-12px); }
        }

        .terry.tired {
            animation-duration: 1.5s;
            opacity: 0.9;
        }

        .terry.determined {
            animation-duration: 0.7s;
            filter: drop-shadow(0 8px 20px rgba(255, 215, 0, 0.6));
        }

        /* Supporters/Donors */
        .supporter {
            position: absolute;
            font-size: 3rem;
            animation: supporterMove 4s linear;
            z-index: 90;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .supporter:hover {
            transform: scale(1.3);
        }

        .supporter:active {
            transform: scale(1.2);
        }

        @keyframes supporterMove {
            0% { right: -100px; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { right: 100vw; opacity: 0; }
        }

        /* Donations Floating Up */
        .donation-collect {
            position: absolute;
            font-size: 2rem;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: donationFloat 1.5s ease-out forwards;
            z-index: 200;
            pointer-events: none;
        }

        @keyframes donationFloat {
            0% { transform: translateY(0) scale(0.5); opacity: 1; }
            100% { transform: translateY(-150px) scale(1.5); opacity: 0; }
        }

        /* Weather Effects */
        .weather-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 80;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .weather-overlay.active { opacity: 1; }

        .rain {
            background: repeating-linear-gradient(0deg, transparent, transparent 10px, rgba(255,255,255,0.1) 10px, rgba(255,255,255,0.1) 12px);
            animation: rainFall 0.5s linear infinite;
        }

        @keyframes rainFall {
            0% { background-position: 0 0; }
            100% { background-position: 0 20px; }
        }

        .wind {
            background: linear-gradient(90deg, transparent 0%, rgba(200,200,200,0.3) 50%, transparent 100%);
            animation: windBlow 2s ease-in-out infinite;
        }

        @keyframes windBlow {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(30px); }
        }

        .sun {
            background: radial-gradient(circle, rgba(255, 200, 0, 0.2) 0%, transparent 70%);
        }

        /* Landmarks */
        .landmark {
            position: absolute;
            font-size: 4rem;
            animation: landmarkMove 6s linear;
            z-index: 50;
            opacity: 0.8;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.3));
        }

        @keyframes landmarkMove {
            0% { right: -100px; transform: scale(0.8); }
            50% { transform: scale(1); }
            100% { right: 100vw; transform: scale(0.8); }
        }

        /* City Sign */
        .city-sign {
            position: absolute;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 20px;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 700;
            animation: signMove 5s linear;
            z-index: 85;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 3px solid white;
        }

        @keyframes signMove {
            0% { right: -300px; }
            100% { right: 100vw; }
        }

        /* Story Modal */
        .story-modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 35px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            z-index: 3000;
            display: none;
            border: 4px solid #ff6b6b;
        }

        .story-modal.active {
            display: block;
            animation: modalAppear 0.5s ease-out;
        }

        @keyframes modalAppear {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .story-modal h2 {
            color: #2c3e50;
            font-size: 2rem;
            margin-bottom: 15px;
            text-align: center;
        }

        .story-modal .location {
            color: #ff6b6b;
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 20px;
        }

        .story-modal p {
            color: #5a6c7d;
            line-height: 1.8;
            font-size: 1.05rem;
            margin-bottom: 15px;
        }

        .story-modal .continue-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .story-modal .continue-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.5);
        }

        /* Start Screen */
        .start-screen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .start-screen h1 {
            font-size: 4rem;
            margin-bottom: 15px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }

        .start-screen .subtitle {
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .start-screen p {
            font-size: 1.1rem;
            margin-bottom: 15px;
            max-width: 600px;
            line-height: 1.6;
            opacity: 0.95;
        }

        .start-screen .device-hint {
            background: rgba(255,255,255,0.15);
            padding: 15px 25px;
            border-radius: 15px;
            margin: 20px 0;
            font-size: 1rem;
        }

        .start-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            color: white;
            border: none;
            padding: 20px 60px;
            border-radius: 30px;
            font-size: 1.6rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.5);
            animation: startBtnPulse 2s ease-in-out infinite;
            margin-top: 20px;
        }

        @keyframes startBtnPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 10px 30px rgba(255, 107, 107, 0.5); }
            50% { transform: scale(1.05); box-shadow: 0 15px 40px rgba(255, 107, 107, 0.7); }
        }

        .start-btn:hover {
            transform: scale(1.08);
        }

        /* Info Panel */
        .info-panel {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 20px;
            z-index: 900;
            border-top: 3px solid #ff6b6b;
        }

        .current-challenge {
            font-size: 1.1rem;
            text-align: center;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .challenge-icon {
            font-size: 1.8rem;
            margin: 0 10px;
        }

        .next-city {
            text-align: center;
            font-size: 0.95rem;
            opacity: 0.8;
        }

        /* Pause Button */
        .pause-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 15px;
            width: 60px;
            height: 60px;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1001;
        }

        .pause-btn:hover {
            background: white;
            transform: scale(1.1);
        }

        /* Pause Screen */
        .pause-screen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .pause-screen.active { display: flex; }

        .pause-screen h2 {
            font-size: 3rem;
            margin-bottom: 30px;
        }

        .pause-stats {
            font-size: 1.3rem;
            margin: 20px 0;
            line-height: 2.5;
        }

        .pause-btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .resume-btn, .restart-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .restart-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        /* Achievement */
        .achievement {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #ffd700, #ffed4a);
            color: #2c3e50;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            animation: achievementPop 3s ease-in-out;
            z-index: 2500;
            max-width: 400px;
            text-align: center;
        }

        @keyframes achievementPop {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            20%, 80% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
        }

        .achievement h3 { font-size: 1.6rem; margin-bottom: 10px; }
        .achievement p { font-size: 1.1rem; opacity: 0.9; }

        /* ========================================
           MOBILE-SPECIFIC STYLES
           ======================================== */

        /* Mobile Game Header - Compact */
        body.mobile-mode .game-header {
            padding: 8px 12px;
        }

        body.mobile-mode .game-title {
            font-size: 1rem;
            margin-bottom: 6px;
        }

        body.mobile-mode .game-stats {
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
            font-size: 0.75rem;
        }

        body.mobile-mode .stat {
            padding: 6px;
            border-radius: 8px;
        }

        body.mobile-mode .stat-label {
            font-size: 0.7em;
        }

        body.mobile-mode .stat-value {
            font-size: 1.1em;
        }

        /* Mobile Determination Meter */
        body.mobile-mode .determination-meter {
            top: 95px;
            left: 12px;
            right: 12px;
        }

        body.mobile-mode .meter-label {
            font-size: 0.85rem;
        }

        body.mobile-mode .meter-bar-container {
            height: 18px;
        }

        /* Mobile Game World - More space */
        body.mobile-mode .game-world {
            top: 145px;
            bottom: 140px;
        }

        /* Mobile Terry - Larger */
        body.mobile-mode .terry {
            font-size: 4.5rem;
            left: 15%;
            bottom: 80px;
        }

        /* Mobile Supporters - MUCH larger touch targets */
        body.mobile-mode .supporter {
            font-size: 4rem;
            min-width: 70px;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Mobile Road */
        body.mobile-mode .road {
            height: 100px;
        }

        /* Mobile Info Panel - Enhanced for thumb zone */
        body.mobile-mode .info-panel {
            padding: 12px 15px;
            padding-bottom: max(12px, env(safe-area-inset-bottom));
        }

        body.mobile-mode .current-challenge {
            font-size: 0.95rem;
            margin-bottom: 6px;
        }

        body.mobile-mode .challenge-icon {
            font-size: 1.4rem;
        }

        body.mobile-mode .next-city {
            font-size: 0.85rem;
        }

        /* Mobile Tap Zone - The big innovation */
        .mobile-tap-zone {
            position: absolute;
            bottom: 85px;
            left: 0;
            right: 0;
            height: 55px;
            background: linear-gradient(180deg, transparent 0%, rgba(255,215,0,0.15) 100%);
            z-index: 850;
            display: none;
            align-items: center;
            justify-content: center;
            border-top: 2px dashed rgba(255,215,0,0.4);
        }

        body.mobile-mode .mobile-tap-zone {
            display: flex;
        }

        .tap-zone-hint {
            color: white;
            font-size: 0.8rem;
            opacity: 0.7;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
            animation: tapHintPulse 2s ease-in-out infinite;
        }

        @keyframes tapHintPulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 0.9; }
        }

        /* Mobile Swipe Boost Indicator */
        .swipe-boost-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #4ecdc4, #44a8b3);
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: 700;
            box-shadow: 0 5px 20px rgba(78, 205, 196, 0.5);
            z-index: 250;
            animation: boostPop 0.8s ease-out forwards;
            display: none;
        }

        body.mobile-mode .swipe-boost-indicator.active {
            display: block;
        }

        @keyframes boostPop {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            30% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }

        /* Mobile Pause Button - Larger */
        body.mobile-mode .pause-btn {
            width: 50px;
            height: 50px;
            font-size: 1.4rem;
            top: 8px;
            right: 8px;
            border-radius: 12px;
        }

        /* Mobile Start Screen */
        body.mobile-mode .start-screen h1 {
            font-size: 2.5rem;
        }

        body.mobile-mode .start-screen .subtitle {
            font-size: 1.3rem;
        }

        body.mobile-mode .start-screen p {
            font-size: 0.95rem;
        }

        body.mobile-mode .start-btn {
            padding: 18px 50px;
            font-size: 1.3rem;
        }

        body.mobile-mode .device-hint {
            font-size: 0.9rem;
            padding: 12px 20px;
        }

        /* Mobile Story Modal */
        body.mobile-mode .story-modal {
            padding: 25px 20px;
            max-width: 95%;
        }

        body.mobile-mode .story-modal h2 {
            font-size: 1.5rem;
        }

        body.mobile-mode .story-modal .location {
            font-size: 1rem;
        }

        body.mobile-mode .story-modal p {
            font-size: 0.95rem;
        }

        body.mobile-mode .story-modal .continue-btn {
            padding: 14px 30px;
            font-size: 1rem;
        }

        /* Mobile Donation Collect - Bigger */
        body.mobile-mode .donation-collect {
            font-size: 2.5rem;
        }

        /* Mobile Landmarks - Smaller to not block */
        body.mobile-mode .landmark {
            font-size: 2.5rem;
            opacity: 0.6;
        }

        /* Mobile City Sign */
        body.mobile-mode .city-sign {
            padding: 12px 18px;
            font-size: 1rem;
        }

        /* Landscape Warning for Mobile */
        .landscape-warning {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 9999;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 30px;
        }

        .landscape-warning .rotate-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: rotatePhone 1.5s ease-in-out infinite;
        }

        @keyframes rotatePhone {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(90deg); }
        }

        .landscape-warning h2 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .landscape-warning p {
            opacity: 0.9;
            font-size: 1rem;
        }

        /* Show landscape warning only on mobile in landscape */
        @media (orientation: landscape) and (max-height: 500px) {
            body.mobile-mode .landscape-warning {
                display: flex;
            }
        }

        /* Desktop keyboard hints */
        .keyboard-hints {
            position: absolute;
            bottom: 110px;
            left: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 0.85rem;
            z-index: 800;
        }

        .keyboard-hints kbd {
            background: rgba(255,255,255,0.2);
            padding: 3px 8px;
            border-radius: 5px;
            margin: 0 3px;
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Landscape Warning (Mobile Only) -->
        <div class="landscape-warning mobile-only">
            <div class="rotate-icon">üì±</div>
            <h2>Please Rotate Your Device</h2>
            <p>This game is best experienced in portrait mode</p>
        </div>

        <!-- Start Screen -->
        <div class="start-screen" id="startScreen">
            <h1>üèÉ TERRY FOX üèÉ</h1>
            <p class="subtitle">Marathon of Hope</p>
            <p>On April 12, 1980, Terry Fox began an extraordinary journey across Canada with one leg and a dream to raise money for cancer research.</p>
            <p>Experience his inspiring journey. Collect supporters and donations. Keep his determination strong through 143 days of running.</p>

            <!-- Mobile-specific hint -->
            <div class="device-hint mobile-only" id="mobileHint">
                üì± <strong>Mobile Controls:</strong><br>
                Tap supporters to collect donations<br>
                Swipe right for a determination boost!
            </div>

            <!-- Desktop-specific hint -->
            <div class="device-hint desktop-only" id="desktopHint">
                üñ±Ô∏è <strong>Desktop Controls:</strong><br>
                Click supporters to collect donations<br>
                Press <kbd>Space</kbd> to pause
            </div>

            <button class="start-btn" id="startBtn">BEGIN THE JOURNEY</button>
        </div>

        <!-- Pause Button -->
        <button class="pause-btn" id="pauseBtn">‚è∏Ô∏è</button>

        <!-- Game Header -->
        <div class="game-header">
            <div class="game-title">Terry Fox: Marathon of Hope</div>
            <div class="game-stats">
                <div class="stat">
                    <span class="stat-label">üìÖ Day</span>
                    <span class="stat-value" id="day">1</span>
                </div>
                <div class="stat">
                    <span class="stat-label">üìç Distance</span>
                    <span class="stat-value"><span id="distance">0</span> km</span>
                </div>
                <div class="stat highlight">
                    <span class="stat-label">üí∞ Raised</span>
                    <span class="stat-value">$<span id="money">0</span></span>
                </div>
                <div class="stat">
                    <span class="stat-label">üë• Supporters</span>
                    <span class="stat-value" id="supporters">0</span>
                </div>
            </div>
        </div>

        <!-- Determination Meter -->
        <div class="determination-meter">
            <div class="meter-label">üí™ DETERMINATION & HOPE</div>
            <div class="meter-bar-container">
                <div class="meter-bar" id="determinationBar" style="width: 100%"></div>
            </div>
        </div>

        <!-- Game World -->
        <div class="game-world" id="gameWorld">
            <div class="weather-overlay" id="weatherOverlay"></div>
            <div class="road" id="road"></div>
            <div class="terry" id="terry">üèÉ‚Äç‚ôÇÔ∏è</div>
            <!-- Mobile Swipe Boost Indicator -->
            <div class="swipe-boost-indicator" id="swipeBoost">‚ö° BOOST! +10 DETERMINATION</div>
        </div>

        <!-- Mobile Tap Zone -->
        <div class="mobile-tap-zone mobile-only" id="mobileTapZone">
            <span class="tap-zone-hint">üëÜ TAP SUPPORTERS TO COLLECT</span>
        </div>

        <!-- Desktop Keyboard Hints -->
        <div class="keyboard-hints desktop-only">
            <kbd>Space</kbd> Pause &nbsp;|&nbsp; <kbd>Click</kbd> Collect
        </div>

        <!-- Info Panel -->
        <div class="info-panel">
            <div class="current-challenge" id="challengeText">
                <span class="challenge-icon" id="challengeIcon">‚òÄÔ∏è</span>
                <span id="challengeMessage">Beautiful day for running!</span>
            </div>
            <div class="next-city">
                Next milestone: <strong id="nextCity">Halifax, NS</strong> - <span id="kmToNext">500</span> km
            </div>
        </div>

        <!-- Story Modal -->
        <div class="story-modal" id="storyModal">
            <h2 id="storyTitle">City Reached!</h2>
            <div class="location" id="storyLocation"></div>
            <div id="storyContent"></div>
            <button class="continue-btn" id="continueBtn">Continue Running</button>
        </div>

        <!-- Pause Screen -->
        <div class="pause-screen" id="pauseScreen">
            <h2>‚è∏Ô∏è Rest Stop</h2>
            <p style="font-size: clamp(1rem, 3vw, 1.3rem); margin: 20px 0; opacity: 0.9;">
                "Even though I'm not running, in my heart I'll always be running."<br>- Terry Fox
            </p>
            <div class="pause-stats">
                <div>üìÖ Day <strong id="pauseDay">1</strong> of 143</div>
                <div>üìç <strong id="pauseDistance">0</strong> km of Terry's journey</div>
                <div>üí∞ $<strong id="pauseMoney">0</strong> raised for cancer research</div>
                <div>üë• <strong id="pauseSupporters">0</strong> supporters collected</div>
            </div>
            <div class="pause-btn-group">
                <button class="resume-btn" id="resumeBtn">Continue Journey</button>
                <button class="restart-btn" id="restartBtn">Restart</button>
            </div>
        </div>
    </div>

    <script>
        // Device Detection
        const DeviceDetector = {
            isMobile: function() {
                // Check multiple signals for mobile detection
                const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                const smallScreen = window.innerWidth <= 768;
                const mobileUA = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

                // Consider it mobile if it has touch AND (small screen OR mobile user agent)
                return hasTouch && (smallScreen || mobileUA);
            },

            applyMode: function() {
                const body = document.body;
                if (this.isMobile()) {
                    body.classList.add('mobile-mode');
                    body.classList.remove('desktop-mode');
                    console.log('üì± Mobile mode activated');
                } else {
                    body.classList.add('desktop-mode');
                    body.classList.remove('mobile-mode');
                    console.log('üñ•Ô∏è Desktop mode activated');
                }
            }
        };

        // Apply mode on load and resize
        DeviceDetector.applyMode();
        window.addEventListener('resize', () => DeviceDetector.applyMode());

        class TerryFoxJourney {
            constructor() {
                // Device mode
                this.isMobile = DeviceDetector.isMobile();

                // Game state
                this.distance = 0;
                this.day = 1;
                this.money = 0;
                this.supporters = 0;
                this.determination = 100;
                this.isPaused = false;
                this.currentCityIndex = 0;

                // Swipe tracking for mobile
                this.touchStartX = 0;
                this.touchStartY = 0;
                this.lastSwipeTime = 0;

                // Cities along Terry's route with real facts
                this.cities = [
                    {
                        name: "St. John's, NL",
                        distance: 0,
                        story: "On April 12, 1980, Terry Fox dipped his artificial leg in the Atlantic Ocean and began his Marathon of Hope. With little fanfare, he started running west, determined to cross Canada and raise money for cancer research.",
                        icon: "üè†"
                    },
                    {
                        name: "Halifax, NS",
                        distance: 500,
                        story: "As Terry ran through the Maritimes, his journey began to gain attention. People started to gather along the roads, inspired by his determination and courage. Every step brought hope to cancer patients across the country.",
                        icon: "‚öì"
                    },
                    {
                        name: "Quebec City, QC",
                        distance: 1200,
                        story: "Running through Quebec, Terry faced language barriers but discovered that his mission transcended words. His dedication spoke louder than any language, inspiring donations from all Canadians.",
                        icon: "üè∞"
                    },
                    {
                        name: "Montreal, QC",
                        distance: 1400,
                        story: "In Montreal, crowds began to swell. Terry's story was spreading across the nation. Despite running a marathon every single day, he made time to speak to supporters, share his dream, and inspire hope.",
                        icon: "üåâ"
                    },
                    {
                        name: "Ottawa, ON",
                        distance: 1600,
                        story: "At the nation's capital, Terry met with officials and continued to gain support. His original goal was to raise $1 from every Canadian - about 24 million dollars. The dream was becoming reality.",
                        icon: "üèõÔ∏è"
                    },
                    {
                        name: "Toronto, ON",
                        distance: 1800,
                        story: "Toronto gave Terry a hero's welcome. Thousands lined the streets. He was running 42 kilometers every single day, the equivalent of a full marathon, regardless of weather or pain.",
                        icon: "üèóÔ∏è"
                    },
                    {
                        name: "Thunder Bay, ON",
                        distance: 2300,
                        story: "On September 1, 1980, after 143 days and 5,373 kilometers, Terry was forced to stop outside Thunder Bay. The cancer had returned, spreading to his lungs. Though his run ended, his legacy was just beginning.",
                        icon: "‚ö°"
                    }
                ];

                // Weather challenges
                this.weatherTypes = [
                    { type: 'sun', icon: '‚òÄÔ∏è', message: 'Beautiful day for running!', class: 'sun', speedMultiplier: 1 },
                    { type: 'rain', icon: 'üåßÔ∏è', message: 'Running through rain - Terry never stopped!', class: 'rain', speedMultiplier: 0.8 },
                    { type: 'wind', icon: 'üí®', message: 'Strong headwinds - pushing forward!', class: 'wind', speedMultiplier: 0.7 },
                    { type: 'heat', icon: 'üî•', message: 'Scorching heat - staying determined!', class: 'sun', speedMultiplier: 0.85 }
                ];

                this.currentWeather = this.weatherTypes[0];

                // Supporter types
                this.supporterTypes = [
                    { emoji: 'üë®', value: 5, name: 'Supporter' },
                    { emoji: 'üë©', value: 5, name: 'Supporter' },
                    { emoji: 'üë¥', value: 10, name: 'Donor' },
                    { emoji: 'üëµ', value: 10, name: 'Donor' },
                    { emoji: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶', value: 25, name: 'Family' },
                    { emoji: 'üë•', value: 50, name: 'Community' },
                    { emoji: 'üè•', value: 100, name: 'Hospital' },
                    { emoji: 'üè¢', value: 200, name: 'Corporation' }
                ];

                this.initializeGame();
            }

            initializeGame() {
                // Basic event listeners
                document.getElementById('startBtn').addEventListener('click', () => this.startGame());
                document.getElementById('pauseBtn').addEventListener('click', () => this.togglePause());
                document.getElementById('resumeBtn').addEventListener('click', () => this.togglePause());
                document.getElementById('restartBtn').addEventListener('click', () => this.restart());
                document.getElementById('continueBtn').addEventListener('click', () => this.closeStory());

                const gameWorld = document.getElementById('gameWorld');

                // MOBILE-SPECIFIC CONTROLS
                if (this.isMobile) {
                    // Touch to collect supporters
                    gameWorld.addEventListener('touchstart', (e) => {
                        if (!this.isPaused && e.target.classList.contains('supporter')) {
                            this.collectSupporter(e.target);
                        }
                        // Track touch start for swipe
                        this.touchStartX = e.touches[0].clientX;
                        this.touchStartY = e.touches[0].clientY;
                    }, { passive: true });

                    // Swipe detection for boost
                    gameWorld.addEventListener('touchend', (e) => {
                        if (this.isPaused) return;

                        const touchEndX = e.changedTouches[0].clientX;
                        const touchEndY = e.changedTouches[0].clientY;
                        const deltaX = touchEndX - this.touchStartX;
                        const deltaY = Math.abs(touchEndY - this.touchStartY);

                        // Swipe right gesture (min 80px, mostly horizontal)
                        if (deltaX > 80 && deltaY < 50) {
                            const now = Date.now();
                            if (now - this.lastSwipeTime > 2000) { // 2s cooldown
                                this.lastSwipeTime = now;
                                this.triggerSwipeBoost();
                            }
                        }
                    }, { passive: true });

                    // Tap zone fallback - collect nearest supporter
                    document.getElementById('mobileTapZone')?.addEventListener('touchstart', (e) => {
                        if (this.isPaused) return;
                        const supporters = document.querySelectorAll('.supporter');
                        if (supporters.length > 0) {
                            // Collect the rightmost (newest) supporter
                            const nearestSupporter = Array.from(supporters).reduce((nearest, current) => {
                                const nearestRect = nearest.getBoundingClientRect();
                                const currentRect = current.getBoundingClientRect();
                                return currentRect.left < nearestRect.left ? current : nearest;
                            });
                            this.collectSupporter(nearestSupporter);
                        }
                    }, { passive: true });

                } else {
                    // DESKTOP CONTROLS
                    // Click to collect supporters
                    gameWorld.addEventListener('click', (e) => {
                        if (!this.isPaused && e.target.classList.contains('supporter')) {
                            this.collectSupporter(e.target);
                        }
                    });

                    // Keyboard controls
                    document.addEventListener('keydown', (e) => {
                        if (e.code === 'Space') {
                            e.preventDefault();
                            if (!document.getElementById('storyModal').classList.contains('active') &&
                                !document.getElementById('startScreen').style.display !== 'none') {
                                this.togglePause();
                            }
                        }
                        // ESC to pause
                        if (e.code === 'Escape') {
                            if (!this.isPaused && !document.getElementById('storyModal').classList.contains('active')) {
                                this.togglePause();
                            }
                        }
                    });
                }
            }

            triggerSwipeBoost() {
                // Add determination boost
                this.determination = Math.min(100, this.determination + 10);

                // Show boost indicator
                const boostEl = document.getElementById('swipeBoost');
                boostEl.classList.add('active');

                // Vibrate
                if ('vibrate' in navigator) {
                    navigator.vibrate([50, 30, 50]);
                }

                // Remove after animation
                setTimeout(() => {
                    boostEl.classList.remove('active');
                }, 800);

                // Show achievement occasionally
                if (Math.random() < 0.3) {
                    this.showAchievement('‚ö° Speed Boost!', 'Terry feels the crowd\'s energy!');
                }
            }

            startGame() {
                document.getElementById('startScreen').style.display = 'none';
                this.showStory(0); // Show opening story
                this.startGameLoop();
                this.startSpawners();
            }

            startGameLoop() {
                this.gameInterval = setInterval(() => {
                    if (!this.isPaused) {
                        this.updateGame();
                    }
                }, 100);
            }

            startSpawners() {
                // Spawn supporters regularly
                this.supporterSpawner = setInterval(() => {
                    if (!this.isPaused) {
                        this.spawnSupporter();
                    }
                }, 2500);

                // Spawn landmarks
                this.landmarkSpawner = setInterval(() => {
                    if (!this.isPaused) {
                        this.spawnLandmark();
                    }
                }, 5000);

                // Change weather occasionally
                this.weatherChanger = setInterval(() => {
                    if (!this.isPaused) {
                        this.changeWeather();
                    }
                }, 15000);
            }

            updateGame() {
                // Progress forward (Terry ran ~42km per day)
                const baseSpeed = 0.15;
                const speedModifier = this.currentWeather.speedMultiplier;
                const determinationModifier = this.determination / 100;

                this.distance += baseSpeed * speedModifier * determinationModifier;

                // Update day (every 42km)
                this.day = Math.min(Math.floor(this.distance / 42) + 1, 143);

                // Determination naturally decreases
                this.determination -= 0.02;
                this.determination = Math.max(0, this.determination);

                // Update UI
                this.updateUI();

                // Check for city milestones
                this.checkCityMilestones();

                // Adjust Terry's appearance based on determination
                this.updateTerryAppearance();

                // Check for completion
                if (this.distance >= 5373) {
                    this.showCompletion();
                }
            }

            updateUI() {
                document.getElementById('day').textContent = this.day;
                document.getElementById('distance').textContent = Math.floor(this.distance);
                document.getElementById('money').textContent = Math.floor(this.money).toLocaleString();
                document.getElementById('supporters').textContent = this.supporters;

                // Update determination bar
                const bar = document.getElementById('determinationBar');
                bar.style.width = Math.max(0, this.determination) + '%';

                if (this.determination < 30) {
                    bar.classList.add('low');
                } else {
                    bar.classList.remove('low');
                }

                // Update pause screen stats
                document.getElementById('pauseDay').textContent = this.day;
                document.getElementById('pauseDistance').textContent = Math.floor(this.distance);
                document.getElementById('pauseMoney').textContent = Math.floor(this.money).toLocaleString();
                document.getElementById('pauseSupporters').textContent = this.supporters;

                // Update next city info
                if (this.currentCityIndex < this.cities.length - 1) {
                    const nextCity = this.cities[this.currentCityIndex + 1];
                    document.getElementById('nextCity').textContent = nextCity.name;
                    document.getElementById('kmToNext').textContent = Math.max(0, Math.floor(nextCity.distance - this.distance));
                }
            }

            updateTerryAppearance() {
                const terry = document.getElementById('terry');
                const road = document.getElementById('road');

                terry.classList.remove('tired', 'determined');
                road.classList.remove('slow', 'fast');

                if (this.determination < 30) {
                    terry.classList.add('tired');
                    road.classList.add('slow');
                } else if (this.determination > 80) {
                    terry.classList.add('determined');
                    road.classList.add('fast');
                }
            }

            spawnSupporter() {
                const supporter = document.createElement('div');
                supporter.className = 'supporter';

                const type = this.supporterTypes[Math.floor(Math.random() * this.supporterTypes.length)];
                supporter.textContent = type.emoji;
                supporter.dataset.value = type.value;
                supporter.dataset.name = type.name;

                // Mobile: position supporters in thumb-friendly zone (lower 60% of game world)
                // Desktop: use full vertical range
                if (this.isMobile) {
                    supporter.style.bottom = Math.random() * 35 + 25 + '%'; // 25-60% from bottom
                } else {
                    supporter.style.bottom = Math.random() * 40 + 30 + '%'; // 30-70% from bottom
                }

                document.getElementById('gameWorld').appendChild(supporter);

                // Mobile: slightly longer time to give more chance to tap
                const duration = this.isMobile ? 4500 : 4000;
                setTimeout(() => {
                    if (supporter.parentNode) {
                        supporter.remove();
                    }
                }, duration);
            }

            collectSupporter(supporterElement) {
                const value = parseInt(supporterElement.dataset.value);
                const name = supporterElement.dataset.name;

                this.money += value;
                this.supporters++;
                this.determination = Math.min(100, this.determination + 5); // Boost determination

                // Show donation collect animation
                const donation = document.createElement('div');
                donation.className = 'donation-collect';
                donation.textContent = '+$' + value;
                donation.style.left = supporterElement.offsetLeft + 'px';
                donation.style.top = supporterElement.offsetTop + 'px';

                document.getElementById('gameWorld').appendChild(donation);

                setTimeout(() => donation.remove(), 1500);

                // Remove supporter
                supporterElement.remove();

                // Vibrate
                if ('vibrate' in navigator) {
                    navigator.vibrate(30);
                }

                // Show achievement for milestones
                if (this.supporters % 50 === 0) {
                    this.showAchievement(`üéâ ${this.supporters} Supporters!`, `The movement is growing!`);
                }
            }

            spawnLandmark() {
                const landmarks = ['üå≤', 'üè†', 'üè≠', '‚õ™', 'üåæ', 'üèîÔ∏è', 'üåä', 'ü¶å', 'üêª'];
                const landmark = document.createElement('div');
                landmark.className = 'landmark';
                landmark.textContent = landmarks[Math.floor(Math.random() * landmarks.length)];
                landmark.style.top = Math.random() * 50 + 10 + '%';

                document.getElementById('gameWorld').appendChild(landmark);

                setTimeout(() => {
                    if (landmark.parentNode) {
                        landmark.remove();
                    }
                }, 6000);
            }

            changeWeather() {
                this.currentWeather = this.weatherTypes[Math.floor(Math.random() * this.weatherTypes.length)];

                const overlay = document.getElementById('weatherOverlay');
                overlay.className = 'weather-overlay ' + this.currentWeather.class + ' active';

                document.getElementById('challengeIcon').textContent = this.currentWeather.icon;
                document.getElementById('challengeMessage').textContent = this.currentWeather.message;

                setTimeout(() => {
                    overlay.classList.remove('active');
                }, 5000);
            }

            checkCityMilestones() {
                if (this.currentCityIndex < this.cities.length - 1) {
                    const nextCity = this.cities[this.currentCityIndex + 1];
                    if (this.distance >= nextCity.distance) {
                        this.currentCityIndex++;
                        this.reachCity(this.currentCityIndex);
                    }
                }
            }

            reachCity(cityIndex) {
                this.isPaused = true;

                // Show city sign first
                const sign = document.createElement('div');
                sign.className = 'city-sign';
                sign.textContent = this.cities[cityIndex].icon + ' ' + this.cities[cityIndex].name;
                sign.style.bottom = '50%';
                document.getElementById('gameWorld').appendChild(sign);

                setTimeout(() => sign.remove(), 5000);

                // Show story
                setTimeout(() => this.showStory(cityIndex), 1000);

                // Vibrate
                if ('vibrate' in navigator) {
                    navigator.vibrate([100, 50, 100, 50, 100]);
                }
            }

            showStory(cityIndex) {
                const city = this.cities[cityIndex];
                const modal = document.getElementById('storyModal');

                document.getElementById('storyTitle').textContent = cityIndex === 0 ? 'The Journey Begins' : 'Milestone Reached!';
                document.getElementById('storyLocation').textContent = city.icon + ' ' + city.name;
                document.getElementById('storyContent').innerHTML = '<p>' + city.story + '</p>';

                modal.classList.add('active');
                this.isPaused = true;
            }

            closeStory() {
                document.getElementById('storyModal').classList.remove('active');
                this.isPaused = false;
            }

            showAchievement(title, message) {
                const achievement = document.createElement('div');
                achievement.className = 'achievement';
                achievement.innerHTML = `
                    <h3>${title}</h3>
                    <p>${message}</p>
                `;

                document.querySelector('.game-container').appendChild(achievement);

                setTimeout(() => achievement.remove(), 3000);
            }

            showCompletion() {
                this.isPaused = true;
                const modal = document.getElementById('storyModal');

                document.getElementById('storyTitle').textContent = 'üèÜ Journey Complete';
                document.getElementById('storyLocation').textContent = '5,373 Kilometers';
                document.getElementById('storyContent').innerHTML = `
                    <p>Though Terry's Marathon of Hope ended at Thunder Bay, his legacy continues forever.</p>
                    <p>You raised <strong>$${Math.floor(this.money).toLocaleString()}</strong> and inspired <strong>${this.supporters}</strong> supporters.</p>
                    <p>Since 1980, the annual Terry Fox Run has raised over $850 million for cancer research worldwide.</p>
                    <p><strong>Terry's dream of finding a cure for cancer lives on through millions who continue to run in his name.</strong></p>
                `;

                document.getElementById('continueBtn').textContent = 'Restart Journey';
                document.getElementById('continueBtn').onclick = () => this.restart();

                modal.classList.add('active');
            }

            togglePause() {
                if (document.getElementById('storyModal').classList.contains('active')) return;

                this.isPaused = !this.isPaused;
                const pauseScreen = document.getElementById('pauseScreen');

                if (this.isPaused) {
                    pauseScreen.classList.add('active');
                    document.getElementById('pauseBtn').textContent = '‚ñ∂Ô∏è';
                    this.updateUI();
                } else {
                    pauseScreen.classList.remove('active');
                    document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è';
                }
            }

            restart() {
                // Clear all spawned elements
                document.querySelectorAll('.supporter, .landmark, .city-sign, .donation-collect, .achievement').forEach(el => el.remove());

                // Reset state
                this.distance = 0;
                this.day = 1;
                this.money = 0;
                this.supporters = 0;
                this.determination = 100;
                this.currentCityIndex = 0;
                this.isPaused = false;

                // Reset UI
                document.getElementById('pauseScreen').classList.remove('active');
                document.getElementById('storyModal').classList.remove('active');
                document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è';
                document.getElementById('continueBtn').textContent = 'Continue Running';
                document.getElementById('continueBtn').onclick = () => this.closeStory();

                this.updateUI();
                this.showStory(0);
            }
        }

        // Start when page loads
        window.addEventListener('load', () => {
            new TerryFoxJourney();
        });

        // Prevent mobile gestures
        document.addEventListener('touchmove', (e) => {
            if (e.target.closest('.game-container')) {
                e.preventDefault();
            }
        }, { passive: false });

        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>
